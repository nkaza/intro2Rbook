<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Exercise 5: Graphics with ggplot | An Introduction to R</title>
  <meta name="description" content="A practical introduction to using R for data analysis" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Exercise 5: Graphics with ggplot | An Introduction to R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://nkaza.github.io/intro2Rbook//images/cover_v4.png" />
  <meta property="og:description" content="A practical introduction to using R for data analysis" />
  <meta name="github-repo" content="nkaza/intro2Rbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Exercise 5: Graphics with ggplot | An Introduction to R" />
  
  <meta name="twitter:description" content="A practical introduction to using R for data analysis" />
  <meta name="twitter:image" content="https://nkaza.github.io/intro2Rbook//images/cover_v4.png" />

<meta name="author" content="Nikhil Kaza" />


<meta name="date" content="2022-08-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="exercise-4-manipulating-data-with-tidyverse-1.html"/>
<link rel="next" href="exercise-5-graphics-with-ggplot-1.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-162377463-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-162377463-3');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">An Introduction R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="0.1" data-path="the-aim-of-this-book.html"><a href="the-aim-of-this-book.html"><i class="fa fa-check"></i><b>0.1</b> The aim of this book</a></li>
<li class="chapter" data-level="0.2" data-path="who-is-this-book-for.html"><a href="who-is-this-book-for.html"><i class="fa fa-check"></i><b>0.2</b> Who is this book for?</a></li>
<li class="chapter" data-level="0.3" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html"><i class="fa fa-check"></i><b>0.3</b> How to use this book</a></li>
<li class="chapter" data-level="0.4" data-path="book-website.html"><a href="book-website.html"><i class="fa fa-check"></i><b>0.4</b> Book website</a></li>
<li class="chapter" data-level="0.5" data-path="some-r-pointers.html"><a href="some-r-pointers.html"><i class="fa fa-check"></i><b>0.5</b> Some R pointers</a></li>
<li class="chapter" data-level="0.6" data-path="license.html"><a href="license.html"><i class="fa fa-check"></i><b>0.6</b> License</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="chap1.html"><a href="chap1.html"><i class="fa fa-check"></i><b>1</b> Getting started with R and RStudio</a>
<ul>
<li class="chapter" data-level="1.1" data-path="install_r.html"><a href="install_r.html"><i class="fa fa-check"></i><b>1.1</b> Installing R</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="install_r.html"><a href="install_r.html#windows-users"><i class="fa fa-check"></i><b>1.1.1</b> Windows users</a></li>
<li class="chapter" data-level="1.1.2" data-path="install_r.html"><a href="install_r.html#mac-users"><i class="fa fa-check"></i><b>1.1.2</b> Mac users</a></li>
<li class="chapter" data-level="1.1.3" data-path="install_r.html"><a href="install_r.html#linux-users"><i class="fa fa-check"></i><b>1.1.3</b> Linux users</a></li>
<li class="chapter" data-level="1.1.4" data-path="install_r.html"><a href="install_r.html#testing-r"><i class="fa fa-check"></i><b>1.1.4</b> Testing R</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="installing-rstudio.html"><a href="installing-rstudio.html"><i class="fa fa-check"></i><b>1.2</b> Installing RStudio</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="installing-rstudio.html"><a href="installing-rstudio.html#windows-and-mac-users"><i class="fa fa-check"></i><b>1.2.1</b> Windows and Mac users</a></li>
<li class="chapter" data-level="1.2.2" data-path="installing-rstudio.html"><a href="installing-rstudio.html#linux-users-1"><i class="fa fa-check"></i><b>1.2.2</b> Linux users</a></li>
<li class="chapter" data-level="1.2.3" data-path="installing-rstudio.html"><a href="installing-rstudio.html#testing-rstudio"><i class="fa fa-check"></i><b>1.2.3</b> Testing RStudio</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="rstudio_orient.html"><a href="rstudio_orient.html"><i class="fa fa-check"></i><b>1.3</b> RStudio orientation</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="rstudio_orient.html"><a href="rstudio_orient.html#cons"><i class="fa fa-check"></i><b>1.3.1</b> Console</a></li>
<li class="chapter" data-level="1.3.2" data-path="rstudio_orient.html"><a href="rstudio_orient.html#environmenthistoryconnections"><i class="fa fa-check"></i><b>1.3.2</b> Environment/History/Connections</a></li>
<li class="chapter" data-level="1.3.3" data-path="rstudio_orient.html"><a href="rstudio_orient.html#filesplotspackageshelpviewer"><i class="fa fa-check"></i><b>1.3.3</b> Files/Plots/Packages/Help/Viewer</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="alternatives-to-rstudio.html"><a href="alternatives-to-rstudio.html"><i class="fa fa-check"></i><b>1.4</b> Alternatives to RStudio</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="alternatives-to-rstudio.html"><a href="alternatives-to-rstudio.html#advanced-text-editors"><i class="fa fa-check"></i><b>1.4.1</b> Advanced text editors</a></li>
<li class="chapter" data-level="1.4.2" data-path="alternatives-to-rstudio.html"><a href="alternatives-to-rstudio.html#integrated-developement-environements"><i class="fa fa-check"></i><b>1.4.2</b> Integrated developement environements</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>1.5</b> R packages</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="packages.html"><a href="packages.html#cran_packages"><i class="fa fa-check"></i><b>1.5.1</b> CRAN packages</a></li>
<li class="chapter" data-level="1.5.2" data-path="packages.html"><a href="packages.html#bioconductor-packages"><i class="fa fa-check"></i><b>1.5.2</b> Bioconductor packages</a></li>
<li class="chapter" data-level="1.5.3" data-path="packages.html"><a href="packages.html#github-packages"><i class="fa fa-check"></i><b>1.5.3</b> GitHub packages</a></li>
<li class="chapter" data-level="1.5.4" data-path="packages.html"><a href="packages.html#using-packages"><i class="fa fa-check"></i><b>1.5.4</b> Using packages</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="rsprojs.html"><a href="rsprojs.html"><i class="fa fa-check"></i><b>1.6</b> Projects in RStudio</a></li>
<li class="chapter" data-level="1.7" data-path="work-d.html"><a href="work-d.html"><i class="fa fa-check"></i><b>1.7</b> Working directories</a></li>
<li class="chapter" data-level="1.8" data-path="dir_struct.html"><a href="dir_struct.html"><i class="fa fa-check"></i><b>1.8</b> Directory structure</a></li>
<li class="chapter" data-level="1.9" data-path="file_names.html"><a href="file_names.html"><i class="fa fa-check"></i><b>1.9</b> File names</a></li>
<li class="chapter" data-level="1.10" data-path="proj_doc.html"><a href="proj_doc.html"><i class="fa fa-check"></i><b>1.10</b> Project documentation</a></li>
<li class="chapter" data-level="1.11" data-path="r-style-guide.html"><a href="r-style-guide.html"><i class="fa fa-check"></i><b>1.11</b> R style guide</a></li>
<li class="chapter" data-level="1.12" data-path="backing-up-projects.html"><a href="backing-up-projects.html"><i class="fa fa-check"></i><b>1.12</b> Backing up projects</a></li>
<li class="chapter" data-level="1.13" data-path="citing-r.html"><a href="citing-r.html"><i class="fa fa-check"></i><b>1.13</b> Citing R</a></li>
<li class="chapter" data-level="1.14" data-path="exercise-1.html"><a href="exercise-1.html"><i class="fa fa-check"></i><b>1.14</b> Exercise 1</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="basics_r.html"><a href="basics_r.html"><i class="fa fa-check"></i><b>2</b> Some R basics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>2.1</b> Getting started</a></li>
<li class="chapter" data-level="2.2" data-path="objects-in-r.html"><a href="objects-in-r.html"><i class="fa fa-check"></i><b>2.2</b> Objects in R</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="objects-in-r.html"><a href="objects-in-r.html#r_objs"><i class="fa fa-check"></i><b>2.2.1</b> Creating objects</a></li>
<li class="chapter" data-level="2.2.2" data-path="objects-in-r.html"><a href="objects-in-r.html#naming-objects"><i class="fa fa-check"></i><b>2.2.2</b> Naming objects</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="using-functions-in-r.html"><a href="using-functions-in-r.html"><i class="fa fa-check"></i><b>2.3</b> Using functions in R</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="using-functions-in-r.html"><a href="using-functions-in-r.html#pipes.-a-better-way"><i class="fa fa-check"></i><b>2.3.1</b> Pipes. A better way!!!!!</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="vectors.html"><a href="vectors.html"><i class="fa fa-check"></i><b>2.4</b> Working with vectors</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="vectors.html"><a href="vectors.html#extracting-elements"><i class="fa fa-check"></i><b>2.4.1</b> Extracting elements</a></li>
<li class="chapter" data-level="2.4.2" data-path="vectors.html"><a href="vectors.html#replacing-elements"><i class="fa fa-check"></i><b>2.4.2</b> Replacing elements</a></li>
<li class="chapter" data-level="2.4.3" data-path="vectors.html"><a href="vectors.html#vec_ord"><i class="fa fa-check"></i><b>2.4.3</b> Ordering elements</a></li>
<li class="chapter" data-level="2.4.4" data-path="vectors.html"><a href="vectors.html#vectorisation"><i class="fa fa-check"></i><b>2.4.4</b> Vectorisation</a></li>
<li class="chapter" data-level="2.4.5" data-path="vectors.html"><a href="vectors.html#na_vals"><i class="fa fa-check"></i><b>2.4.5</b> Missing data</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="help.html"><a href="help.html"><i class="fa fa-check"></i><b>2.5</b> Getting help</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="help.html"><a href="help.html#r-help"><i class="fa fa-check"></i><b>2.5.1</b> R help</a></li>
<li class="chapter" data-level="2.5.2" data-path="help.html"><a href="help.html#rhelp"><i class="fa fa-check"></i><b>2.5.2</b> Other sources of help</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="saving-stuff-in-r.html"><a href="saving-stuff-in-r.html"><i class="fa fa-check"></i><b>2.6</b> Saving stuff in R</a></li>
<li class="chapter" data-level="2.7" data-path="exercise-2.html"><a href="exercise-2.html"><i class="fa fa-check"></i><b>2.7</b> Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data_r.html"><a href="data_r.html"><i class="fa fa-check"></i><b>3</b> Data in R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="basic-data-types.html"><a href="basic-data-types.html"><i class="fa fa-check"></i><b>3.1</b> Basic Data types</a></li>
<li class="chapter" data-level="3.2" data-path="complicated-data-types.html"><a href="complicated-data-types.html"><i class="fa fa-check"></i><b>3.2</b> Complicated Data Types</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="complicated-data-types.html"><a href="complicated-data-types.html#dealing-with-date-and-time"><i class="fa fa-check"></i><b>3.2.1</b> Dealing with Date and Time</a></li>
<li class="chapter" data-level="3.2.2" data-path="complicated-data-types.html"><a href="complicated-data-types.html#factors"><i class="fa fa-check"></i><b>3.2.2</b> Factors</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-structures.html"><a href="data-structures.html"><i class="fa fa-check"></i><b>3.3</b> Data structures</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-structures.html"><a href="data-structures.html#scal_vecs"><i class="fa fa-check"></i><b>3.3.1</b> Scalars and vectors</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-structures.html"><a href="data-structures.html#mat_array"><i class="fa fa-check"></i><b>3.3.2</b> Matrices and arrays</a></li>
<li class="chapter" data-level="3.3.3" data-path="data-structures.html"><a href="data-structures.html#lists"><i class="fa fa-check"></i><b>3.3.3</b> Lists</a></li>
<li class="chapter" data-level="3.3.4" data-path="data-structures.html"><a href="data-structures.html#df"><i class="fa fa-check"></i><b>3.3.4</b> Data frames</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="importing-data.html"><a href="importing-data.html"><i class="fa fa-check"></i><b>3.4</b> Importing data</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="importing-data.html"><a href="importing-data.html#saving-files-to-import"><i class="fa fa-check"></i><b>3.4.1</b> Saving files to import</a></li>
<li class="chapter" data-level="3.4.2" data-path="importing-data.html"><a href="importing-data.html#import_fnc"><i class="fa fa-check"></i><b>3.4.2</b> Import functions</a></li>
<li class="chapter" data-level="3.4.3" data-path="importing-data.html"><a href="importing-data.html#common-import-frustrations"><i class="fa fa-check"></i><b>3.4.3</b> Common import frustrations</a></li>
<li class="chapter" data-level="3.4.4" data-path="importing-data.html"><a href="importing-data.html#import_other"><i class="fa fa-check"></i><b>3.4.4</b> Other import options</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="wrangling-data-frames.html"><a href="wrangling-data-frames.html"><i class="fa fa-check"></i><b>3.5</b> Wrangling data frames</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="wrangling-data-frames.html"><a href="wrangling-data-frames.html#positional-indexes"><i class="fa fa-check"></i><b>3.5.1</b> Positional indexes</a></li>
<li class="chapter" data-level="3.5.2" data-path="wrangling-data-frames.html"><a href="wrangling-data-frames.html#logical-indexes"><i class="fa fa-check"></i><b>3.5.2</b> Logical indexes</a></li>
<li class="chapter" data-level="3.5.3" data-path="wrangling-data-frames.html"><a href="wrangling-data-frames.html#adding-columns-and-rows"><i class="fa fa-check"></i><b>3.5.3</b> Adding columns and rows</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="summarising-data-frames.html"><a href="summarising-data-frames.html"><i class="fa fa-check"></i><b>3.6</b> Summarising data frames</a></li>
<li class="chapter" data-level="3.7" data-path="exporting-data.html"><a href="exporting-data.html"><i class="fa fa-check"></i><b>3.7</b> Exporting data</a></li>
<li class="chapter" data-level="3.8" data-path="exercise-3.html"><a href="exercise-3.html"><i class="fa fa-check"></i><b>3.8</b> Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data_tidyverse.html"><a href="data_tidyverse.html"><i class="fa fa-check"></i><b>4</b> Tidyverse</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-frames-tibbles.html"><a href="data-frames-tibbles.html"><i class="fa fa-check"></i><b>4.1</b> Data Frames &amp; Tibbles</a></li>
<li class="chapter" data-level="4.2" data-path="reading-external-data.html"><a href="reading-external-data.html"><i class="fa fa-check"></i><b>4.2</b> Reading external data</a></li>
<li class="chapter" data-level="4.3" data-path="wrangling-data.html"><a href="wrangling-data.html"><i class="fa fa-check"></i><b>4.3</b> Wrangling Data</a></li>
<li class="chapter" data-level="4.4" data-path="relational-data.html"><a href="relational-data.html"><i class="fa fa-check"></i><b>4.4</b> Relational Data</a></li>
<li class="chapter" data-level="4.5" data-path="exercise-4.html"><a href="exercise-4.html"><i class="fa fa-check"></i><b>4.5</b> Exercise 4</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="graphics_r.html"><a href="graphics_r.html"><i class="fa fa-check"></i><b>5</b> Graphics with ggplot</a>
<ul>
<li class="chapter" data-level="5.1" data-path="beginning-at-the-end.html"><a href="beginning-at-the-end.html"><i class="fa fa-check"></i><b>5.1</b> Beginning at the end</a></li>
<li class="chapter" data-level="5.2" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html"><i class="fa fa-check"></i><b>5.2</b> The start of the end</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#the-purest-of-ggplots"><i class="fa fa-check"></i><b>5.2.1</b> The purest of ggplots</a></li>
<li class="chapter" data-level="5.2.2" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#wrapping-grids"><i class="fa fa-check"></i><b>5.2.2</b> Wrapping grids</a></li>
<li class="chapter" data-level="5.2.3" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#plotting-multiple-ggplots"><i class="fa fa-check"></i><b>5.2.3</b> Plotting multiple ggplots</a></li>
<li class="chapter" data-level="5.2.4" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#make-it-your-own"><i class="fa fa-check"></i><b>5.2.4</b> Make it your own</a></li>
<li class="chapter" data-level="5.2.5" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#setting-the-theme"><i class="fa fa-check"></i><b>5.2.5</b> Setting the theme</a></li>
<li class="chapter" data-level="5.2.6" data-path="the-start-of-the-end.html"><a href="the-start-of-the-end.html#prettification"><i class="fa fa-check"></i><b>5.2.6</b> Prettification</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="tips.html"><a href="tips.html"><i class="fa fa-check"></i><b>5.3</b> Tips and tricks</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="tips.html"><a href="tips.html#statistics-layer"><i class="fa fa-check"></i><b>5.3.1</b> Statistics layer</a></li>
<li class="chapter" data-level="5.3.2" data-path="tips.html"><a href="tips.html#axis-limits-and-zooms"><i class="fa fa-check"></i><b>5.3.2</b> Axis limits and zooms</a></li>
<li class="chapter" data-level="5.3.3" data-path="tips.html"><a href="tips.html#layering-layers"><i class="fa fa-check"></i><b>5.3.3</b> Layering layers</a></li>
<li class="chapter" data-level="5.3.4" data-path="tips.html"><a href="tips.html#continuous-colours"><i class="fa fa-check"></i><b>5.3.4</b> Continuous colours</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="exercise-5.html"><a href="exercise-5.html"><i class="fa fa-check"></i><b>5.4</b> Exercise 5</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="prog_r.html"><a href="prog_r.html"><i class="fa fa-check"></i><b>6</b> Programming in R</a>
<ul>
<li class="chapter" data-level="6.1" data-path="functions-in-r.html"><a href="functions-in-r.html"><i class="fa fa-check"></i><b>6.1</b> Functions in R</a></li>
<li class="chapter" data-level="6.2" data-path="conditional-statements.html"><a href="conditional-statements.html"><i class="fa fa-check"></i><b>6.2</b> Conditional statements</a></li>
<li class="chapter" data-level="6.3" data-path="combining-logical-operators.html"><a href="combining-logical-operators.html"><i class="fa fa-check"></i><b>6.3</b> Combining logical operators</a></li>
<li class="chapter" data-level="6.4" data-path="loops.html"><a href="loops.html"><i class="fa fa-check"></i><b>6.4</b> Loops</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="loops.html"><a href="loops.html#for-loop"><i class="fa fa-check"></i><b>6.4.1</b> For loop</a></li>
<li class="chapter" data-level="6.4.2" data-path="loops.html"><a href="loops.html#while-loop"><i class="fa fa-check"></i><b>6.4.2</b> While loop</a></li>
<li class="chapter" data-level="6.4.3" data-path="loops.html"><a href="loops.html#when-to-use-a-loop"><i class="fa fa-check"></i><b>6.4.3</b> When to use a loop?</a></li>
<li class="chapter" data-level="6.4.4" data-path="loops.html"><a href="loops.html#if-not-loops-then-what"><i class="fa fa-check"></i><b>6.4.4</b> If not loops, then what?</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="exercise-6.html"><a href="exercise-6.html"><i class="fa fa-check"></i><b>6.5</b> Exercise 6</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="install-rm.html"><a href="install-rm.html"><i class="fa fa-check"></i><b>A</b> Installing R Markdown</a>
<ul>
<li class="chapter" data-level="A.1" data-path="ms-windows.html"><a href="ms-windows.html"><i class="fa fa-check"></i><b>A.1</b> MS Windows</a></li>
<li class="chapter" data-level="A.2" data-path="mac-osx.html"><a href="mac-osx.html"><i class="fa fa-check"></i><b>A.2</b> Mac OSX</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="rmarkdown_r.html"><a href="rmarkdown_r.html"><i class="fa fa-check"></i><b>B</b> Reproducible reports with R markdown</a>
<ul>
<li class="chapter" data-level="B.1" data-path="what-is-r-markdown.html"><a href="what-is-r-markdown.html"><i class="fa fa-check"></i><b>B.1</b> What is R markdown?</a></li>
<li class="chapter" data-level="B.2" data-path="why-use-r-markdown.html"><a href="why-use-r-markdown.html"><i class="fa fa-check"></i><b>B.2</b> Why use R markdown?</a></li>
<li class="chapter" data-level="B.3" data-path="get-started-with-r-markdown.html"><a href="get-started-with-r-markdown.html"><i class="fa fa-check"></i><b>B.3</b> Get started with R markdown</a></li>
<li class="chapter" data-level="B.4" data-path="new_rm.html"><a href="new_rm.html"><i class="fa fa-check"></i><b>B.4</b> Create an R markdown document</a></li>
<li class="chapter" data-level="B.5" data-path="r-markdown-anatomy.html"><a href="r-markdown-anatomy.html"><i class="fa fa-check"></i><b>B.5</b> R markdown anatomy</a>
<ul>
<li class="chapter" data-level="B.5.1" data-path="r-markdown-anatomy.html"><a href="r-markdown-anatomy.html#yaml-header"><i class="fa fa-check"></i><b>B.5.1</b> YAML header</a></li>
<li class="chapter" data-level="B.5.2" data-path="r-markdown-anatomy.html"><a href="r-markdown-anatomy.html#formatted-text"><i class="fa fa-check"></i><b>B.5.2</b> Formatted text</a></li>
<li class="chapter" data-level="B.5.3" data-path="r-markdown-anatomy.html"><a href="r-markdown-anatomy.html#code_chunks"><i class="fa fa-check"></i><b>B.5.3</b> Code chunks</a></li>
<li class="chapter" data-level="B.5.4" data-path="r-markdown-anatomy.html"><a href="r-markdown-anatomy.html#adding-figures"><i class="fa fa-check"></i><b>B.5.4</b> Adding figures</a></li>
<li class="chapter" data-level="B.5.5" data-path="r-markdown-anatomy.html"><a href="r-markdown-anatomy.html#adding-tables"><i class="fa fa-check"></i><b>B.5.5</b> Adding tables</a></li>
<li class="chapter" data-level="B.5.6" data-path="r-markdown-anatomy.html"><a href="r-markdown-anatomy.html#inline-r-code"><i class="fa fa-check"></i><b>B.5.6</b> Inline R code</a></li>
</ul></li>
<li class="chapter" data-level="B.6" data-path="tips_tricks.html"><a href="tips_tricks.html"><i class="fa fa-check"></i><b>B.6</b> Some tips and tricks</a></li>
<li class="chapter" data-level="B.7" data-path="further-information.html"><a href="further-information.html"><i class="fa fa-check"></i><b>B.7</b> Further Information</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="github_r.html"><a href="github_r.html"><i class="fa fa-check"></i><b>C</b> Version control with Git and GitHub</a>
<ul>
<li class="chapter" data-level="C.1" data-path="what-is-version-control.html"><a href="what-is-version-control.html"><i class="fa fa-check"></i><b>C.1</b> What is version control?</a></li>
<li class="chapter" data-level="C.2" data-path="why-use-version-control.html"><a href="why-use-version-control.html"><i class="fa fa-check"></i><b>C.2</b> Why use version control?</a></li>
<li class="chapter" data-level="C.3" data-path="what-is-git-and-github.html"><a href="what-is-git-and-github.html"><i class="fa fa-check"></i><b>C.3</b> What is Git and GitHub?</a></li>
<li class="chapter" data-level="C.4" data-path="setup_git.html"><a href="setup_git.html"><i class="fa fa-check"></i><b>C.4</b> Getting started</a>
<ul>
<li class="chapter" data-level="C.4.1" data-path="setup_git.html"><a href="setup_git.html#install-git"><i class="fa fa-check"></i><b>C.4.1</b> Install Git</a></li>
<li class="chapter" data-level="C.4.2" data-path="setup_git.html"><a href="setup_git.html#configure-git"><i class="fa fa-check"></i><b>C.4.2</b> Configure Git</a></li>
<li class="chapter" data-level="C.4.3" data-path="setup_git.html"><a href="setup_git.html#rs_config"><i class="fa fa-check"></i><b>C.4.3</b> Configure RStudio</a></li>
<li class="chapter" data-level="C.4.4" data-path="setup_git.html"><a href="setup_git.html#register-a-github-account"><i class="fa fa-check"></i><b>C.4.4</b> Register a GitHub account</a></li>
</ul></li>
<li class="chapter" data-level="C.5" data-path="setting-up-a-project-in-rstudio.html"><a href="setting-up-a-project-in-rstudio.html"><i class="fa fa-check"></i><b>C.5</b> Setting up a project in RStudio</a>
<ul>
<li class="chapter" data-level="C.5.1" data-path="setting-up-a-project-in-rstudio.html"><a href="setting-up-a-project-in-rstudio.html#opt1"><i class="fa fa-check"></i><b>C.5.1</b> Option 1 - GitHub first</a></li>
<li class="chapter" data-level="C.5.2" data-path="setting-up-a-project-in-rstudio.html"><a href="setting-up-a-project-in-rstudio.html#opt2"><i class="fa fa-check"></i><b>C.5.2</b> Option 2 - RStudio first</a></li>
</ul></li>
<li class="chapter" data-level="C.6" data-path="use_git.html"><a href="use_git.html"><i class="fa fa-check"></i><b>C.6</b> Using Git</a>
<ul>
<li class="chapter" data-level="C.6.1" data-path="use_git.html"><a href="use_git.html#tracking-changes"><i class="fa fa-check"></i><b>C.6.1</b> Tracking changes</a></li>
<li class="chapter" data-level="C.6.2" data-path="use_git.html"><a href="use_git.html#commit-history"><i class="fa fa-check"></i><b>C.6.2</b> Commit history</a></li>
<li class="chapter" data-level="C.6.3" data-path="use_git.html"><a href="use_git.html#undo"><i class="fa fa-check"></i><b>C.6.3</b> Reverting changes</a></li>
<li class="chapter" data-level="C.6.4" data-path="use_git.html"><a href="use_git.html#collab"><i class="fa fa-check"></i><b>C.6.4</b> Collaborate with Git</a></li>
<li class="chapter" data-level="C.6.5" data-path="use_git.html"><a href="use_git.html#git-tips"><i class="fa fa-check"></i><b>C.6.5</b> Git tips</a></li>
</ul></li>
<li class="chapter" data-level="C.7" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i><b>C.7</b> Further resources</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An Introduction to R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exercise-5-graphics-with-ggplot" class="section level1 unlisted unnumbered hasAnchor">
<h1>Exercise 5: Graphics with ggplot<a href="exercise-5-graphics-with-ggplot.html#exercise-5-graphics-with-ggplot" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p> </p>
<p>In this exercise you’ll learn how to use ggplot2 package to visualize the variable we are interested in <a href="https://nkaza.github.io/intro2Rbook/graphics_r.html">Chapter 5</a> of the Introduction to R book.
 </p>
<ol style="list-style-type: decimal">
<li>As in previous exercises, either create a new R script or continue with your previous R script in your RStudio Project. Again, make sure you include any metadata you feel is appropriate (title, description of task, date of creation etc) and don’t forget to comment out your metadata with a <code>#</code> at the beginning of the line.</li>
</ol>
<p> </p>
<ol start="2" style="list-style-type: decimal">
<li>Download the data file <em>‘AQI_March_Joint.csv’</em> we generated in Exercise 4’s Q15 from the <strong><a href="https://github.com/nkaza/intro2Rbook/tree/master/data"><i class="fa fa-download"></i> Data</a></strong> link and save it to the <code>data</code> directory inside your RStudio project directory.</li>
</ol>
<p><br />
</p>
<ol start="3" style="list-style-type: decimal">
<li>Time for a quick description of the dataset to get your bearings. PurpleAir is a community system of PM (10, 2.5, 1.0) low-cost sensors measuring particulate matter. The PurpleAir system is composed of many sensors that are installed, controlled and maintained by members of the community.PurpleAir sensors measure airborne particulate matter (PM). Particulate matter describes solid particles suspended in air; this includes dust, smoke, and other organic and inorganic particles. PurpleAir sensors use laser particle counters to count the number of particles by particle sizes 0.3, 0.5, 1, 2.5, 5, and 10 <span class="math inline">\(\mu\)</span>m, and use the count data to calculate mass concentrations of PM1.0, PM2.5, and PM10.The PM concentration can be calculated into Air quality index (AQI), which is used for reporting daily air quality ranging from 0-500. If a AQI value is higher than 100, we may suppose that the local area is polluted. Other than PM concentration, PurpleAir sensors also measure the other meteorological factors like temperature and humidity.</li>
</ol>
<p>In this sample dataset, we use the records of 144 PurpleAir sensors in North Carolina generating during 2022/03/01 to 2022/03/20. The dataset is cleaned by removing the NA records or outliers in AQI and temperature. In addition, we already joined the information about the county in which the sensor is located. Those categorical variables include: Office of Management and Budget’s classification of urbanness (“omb”) (urban center, urban outlaying and non urban),unemployment rate (“unemp”) (high/medium/low), median income (“medinc”) (high/medium low) and location (“pz”) (NorthCentral, Piedmont etc.).</p>
<p> </p>
<ol start="4" style="list-style-type: decimal">
<li>Please review the section <a href="https://nkaza.github.io/intro2Rbook/importing-data.html#import_fnc">Section 3.4.2 Import functions</a> of the Introduction to R book or watch this <a href="https://alexd106.github.io/intro2R/howto.html#import-vid">video</a> if you need any further information. Then import the “NC_AQI_data.csv” data.You may install tidyverse package at first and then apply the <code>read_csv()</code> function to load the dataset. Please review the <a href="https://nkaza.github.io/intro2Rbook/data-frames-tibbles.html">Section 4.1 Data Frames &amp; Tibbles</a> for the tidyverse package as well as the <a href="https://nkaza.github.io/intro2Rbook/reading-external-data.html">Section 4.2 Reading external data</a></li>
</ol>
<p> </p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="exercise-5-graphics-with-ggplot.html#cb338-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb338-2"><a href="exercise-5-graphics-with-ggplot.html#cb338-2" aria-hidden="true" tabindex="-1"></a>AQI_March_Joint <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;AQI_March_joint.csv&quot;</span>)</span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Once you have imported your data file, to examine the contents of the dataframe you may replicate the <code>str()</code> function to display the structure of the dataset and a neat summary of your variables. How many observations does this dataset have? How many variables are in this dataset? What type of variables are <code>ID</code> and <code>date_collected</code>?</li>
</ol>
<p> </p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="exercise-5-graphics-with-ggplot.html#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(AQI_March_Joint) <span class="co"># display the first 5 rows</span></span>
<span id="cb339-2"><a href="exercise-5-graphics-with-ggplot.html#cb339-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(AQI_March_Joint) <span class="co"># display the variable names</span></span>
<span id="cb339-3"><a href="exercise-5-graphics-with-ggplot.html#cb339-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(AQI_March_Joint) <span class="co"># display the structure of the dataframe NC_AQI_data</span></span></code></pre></div>
<ol start="6" style="list-style-type: decimal">
<li>You may review the <code>summary()</code> function. This will provide you with some useful summary statistics for each variable. Notice how the type of output depends on whether the variable is a factor or a number. Another useful feature of the <code>summary()</code> function is that it will also count the number of missing values in each variable. Besides, for the numeric variables, you can also apply the <code>summary()</code> function to identify the distribution pattern of each variable, like finding potential outliers or exterme values. Which variables have missing values and how many? Besides, which variable potentially have outliers we need to remove in the data preprocessing session?</li>
</ol>
<p><br />
</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="exercise-5-graphics-with-ggplot.html#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(AQI_March_Joint)</span></code></pre></div>
<ol start="7" style="list-style-type: decimal">
<li>Firstly,please review the <a href="https://nkaza.github.io/intro2Rbook/wrangling-data.html">Section 4.3 Wrangling Data</a> and filter the Durham county’s record to make our first graph. So please use the <code>filter</code>function and apply the code <code>filter(County=="Durham")</code> to define a subset. How many records remained for Durham county?</li>
</ol>
<p> </p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="exercise-5-graphics-with-ggplot.html#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb341-2"><a href="exercise-5-graphics-with-ggplot.html#cb341-2" aria-hidden="true" tabindex="-1"></a>Durham_AQI_March <span class="ot">&lt;-</span> AQI_March_Joint <span class="sc">%&gt;%</span></span>
<span id="cb341-3"><a href="exercise-5-graphics-with-ggplot.html#cb341-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(County <span class="sc">==</span> <span class="st">&quot;Durham&quot;</span>)</span></code></pre></div>
<ol start="8" style="list-style-type: decimal">
<li>As we want to make a graph between the day number of year 2022 and AQI in Durham. You may refer to this <a href="https://lubridate.tidyverse.org/">instruction</a> of the “lubridate” package and apply the function <code>yday</code> within the <code>mutate</code>function to generate a new variable representing the day number of year 2022.<br />
</li>
</ol>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="exercise-5-graphics-with-ggplot.html#cb342-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb342-2"><a href="exercise-5-graphics-with-ggplot.html#cb342-2" aria-hidden="true" tabindex="-1"></a>Durham_AQI_March_day <span class="ot">&lt;-</span> Durham_AQI_March <span class="sc">%&gt;%</span></span>
<span id="cb342-3"><a href="exercise-5-graphics-with-ggplot.html#cb342-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">day_number =</span> <span class="fu">yday</span>(date_collected))</span></code></pre></div>
<p><br />
</p>
<ol start="9" style="list-style-type: decimal">
<li>Next we will make a scatter plot between the day number of year and AQI in Durham. As Durham has multiple sensors, we may also use different colors to differentiate the sensors’ records. Besides, we can also add a trend line between the two variables Please refer to the sample code in the <a href="https://nkaza.github.io/intro2Rbook/the-start-of-the-end.html#wrapping-grids">5.2.2 Wrapping Grids</a>. In this case, if we want to treat “sensor_ID” as a character instead of a number,please refer to the <a href="https://nkaza.github.io/intro2Rbook/summarising-data-frames.html#summarising-data-frames">Section 3.6 Summarising data frames</a>.</li>
</ol>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="exercise-5-graphics-with-ggplot.html#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb343-2"><a href="exercise-5-graphics-with-ggplot.html#cb343-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-3"><a href="exercise-5-graphics-with-ggplot.html#cb343-3" aria-hidden="true" tabindex="-1"></a>Durham_AQI_March_day <span class="sc">%&lt;&gt;%</span> <span class="fu">mutate</span>(<span class="at">sensor_ID =</span> <span class="fu">as.character</span>(sensor_ID))</span>
<span id="cb343-4"><a href="exercise-5-graphics-with-ggplot.html#cb343-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-5"><a href="exercise-5-graphics-with-ggplot.html#cb343-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">day_number</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">AQI</span><span class="st">`</span>), <span class="at">data =</span> Durham_AQI_March_day) <span class="sc">+</span></span>
<span id="cb343-6"><a href="exercise-5-graphics-with-ggplot.html#cb343-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="st">`</span><span class="at">sensor_ID</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb343-7"><a href="exercise-5-graphics-with-ggplot.html#cb343-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>)</span></code></pre></div>
<p> </p>
<ol start="10" style="list-style-type: decimal">
<li>Now we are going to visualize the temperature and AQI on all counties’ records in NC. As the dataset is relatively large, our main figure can be split the “omb” (representing the office management and budget) variable and the “medinc” (representing the medium income level) variable by applying the <code>facet_grid</code> function according to the <a href="https://nkaza.github.io/intro2Rbook/the-start-of-the-end.html#wrapping-grids">5.2.2 Wrapping Grids</a> section.</li>
</ol>
<p> </p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="exercise-5-graphics-with-ggplot.html#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">temperature</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">AQI</span><span class="st">`</span>), <span class="at">data =</span> AQI_March_Joint) <span class="sc">+</span></span>
<span id="cb344-2"><a href="exercise-5-graphics-with-ggplot.html#cb344-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span></span>
<span id="cb344-3"><a href="exercise-5-graphics-with-ggplot.html#cb344-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="sc">+</span></span>
<span id="cb344-4"><a href="exercise-5-graphics-with-ggplot.html#cb344-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="st">`</span><span class="at">omb</span><span class="st">`</span> <span class="sc">~</span> <span class="st">`</span><span class="at">medinc</span><span class="st">`</span>)</span></code></pre></div>
<p>11. Now we want to generate two sets of figures both faceting on the “omb” and “medinc” variables. The first one illustrates the day number of 2022 and temperature, and the second one illustrates the day number of 2022 and AQI. We also use different colors to differentiate the levels of “unemp” varaible representing the unemployment. <a href="https://nkaza.github.io/intro2Rbook/the-start-of-the-end.html#plotting-multiple-ggplots">Section 5.2.3 Plotting multiple ggplots</a>, install and library the “patchwork” packages; then generate the two faceting grid graphs first and apply the <code>g_1/g_2</code>fucntion to combine them.</p>
<p> </p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="exercise-5-graphics-with-ggplot.html#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb345-2"><a href="exercise-5-graphics-with-ggplot.html#cb345-2" aria-hidden="true" tabindex="-1"></a>AQI_March_Joint <span class="ot">&lt;-</span> AQI_March_Joint <span class="sc">%&gt;%</span></span>
<span id="cb345-3"><a href="exercise-5-graphics-with-ggplot.html#cb345-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">day_number =</span> <span class="fu">yday</span>(date_collected))</span>
<span id="cb345-4"><a href="exercise-5-graphics-with-ggplot.html#cb345-4" aria-hidden="true" tabindex="-1"></a>g_temperature <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">day_number</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">temperature</span><span class="st">`</span>, <span class="at">color =</span> <span class="st">`</span><span class="at">unemp</span><span class="st">`</span>), <span class="at">data =</span> AQI_March_Joint) <span class="sc">+</span></span>
<span id="cb345-5"><a href="exercise-5-graphics-with-ggplot.html#cb345-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span></span>
<span id="cb345-6"><a href="exercise-5-graphics-with-ggplot.html#cb345-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="sc">+</span></span>
<span id="cb345-7"><a href="exercise-5-graphics-with-ggplot.html#cb345-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="st">`</span><span class="at">omb</span><span class="st">`</span> <span class="sc">~</span> <span class="st">`</span><span class="at">medinc</span><span class="st">`</span>)</span>
<span id="cb345-8"><a href="exercise-5-graphics-with-ggplot.html#cb345-8" aria-hidden="true" tabindex="-1"></a>g_temperature</span>
<span id="cb345-9"><a href="exercise-5-graphics-with-ggplot.html#cb345-9" aria-hidden="true" tabindex="-1"></a>g_AQI <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">day_number</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">AQI</span><span class="st">`</span>, <span class="at">color =</span> <span class="st">`</span><span class="at">unemp</span><span class="st">`</span>), <span class="at">data =</span> AQI_March_Joint) <span class="sc">+</span></span>
<span id="cb345-10"><a href="exercise-5-graphics-with-ggplot.html#cb345-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span></span>
<span id="cb345-11"><a href="exercise-5-graphics-with-ggplot.html#cb345-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="sc">+</span></span>
<span id="cb345-12"><a href="exercise-5-graphics-with-ggplot.html#cb345-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="st">`</span><span class="at">omb</span><span class="st">`</span> <span class="sc">~</span> <span class="st">`</span><span class="at">medinc</span><span class="st">`</span>)</span>
<span id="cb345-13"><a href="exercise-5-graphics-with-ggplot.html#cb345-13" aria-hidden="true" tabindex="-1"></a>g_AQI</span>
<span id="cb345-14"><a href="exercise-5-graphics-with-ggplot.html#cb345-14" aria-hidden="true" tabindex="-1"></a>g_temperature_AQI <span class="ot">&lt;-</span> g_temperature <span class="sc">/</span> g_AQI</span>
<span id="cb345-15"><a href="exercise-5-graphics-with-ggplot.html#cb345-15" aria-hidden="true" tabindex="-1"></a>g_temperature_AQI</span></code></pre></div>
<ol start="12" style="list-style-type: decimal">
<li>Now let’s polish this figure by applying the “theme_rbook” theme defined in the <a href="https://nkaza.github.io/intro2Rbook/the-start-of-the-end.html#setting-the-theme">5.2.5 Setting the theme</a> for more information.You may apply the “theme_rbook” theme to the two faceting grid graphs one by one, then combine the two polished graphs.</li>
</ol>
<p> </p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="exercise-5-graphics-with-ggplot.html#cb346-1" aria-hidden="true" tabindex="-1"></a>theme_rbook <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">base_size =</span> <span class="dv">28</span>, <span class="at">base_family =</span> <span class="st">&quot;&quot;</span>, <span class="at">base_line_size =</span> base_size <span class="sc">/</span> <span class="dv">22</span>,</span>
<span id="cb346-2"><a href="exercise-5-graphics-with-ggplot.html#cb346-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">base_rect_size =</span> base_size <span class="sc">/</span> <span class="dv">22</span>) {</span>
<span id="cb346-3"><a href="exercise-5-graphics-with-ggplot.html#cb346-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb346-4"><a href="exercise-5-graphics-with-ggplot.html#cb346-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb346-5"><a href="exercise-5-graphics-with-ggplot.html#cb346-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb346-6"><a href="exercise-5-graphics-with-ggplot.html#cb346-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb346-7"><a href="exercise-5-graphics-with-ggplot.html#cb346-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">&quot;italic&quot;</span>),</span>
<span id="cb346-8"><a href="exercise-5-graphics-with-ggplot.html#cb346-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb346-9"><a href="exercise-5-graphics-with-ggplot.html#cb346-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb346-10"><a href="exercise-5-graphics-with-ggplot.html#cb346-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;#cddcdd&quot;</span>),</span>
<span id="cb346-11"><a href="exercise-5-graphics-with-ggplot.html#cb346-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb346-12"><a href="exercise-5-graphics-with-ggplot.html#cb346-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb346-13"><a href="exercise-5-graphics-with-ggplot.html#cb346-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb346-14"><a href="exercise-5-graphics-with-ggplot.html#cb346-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span></span>
<span id="cb346-15"><a href="exercise-5-graphics-with-ggplot.html#cb346-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb346-16"><a href="exercise-5-graphics-with-ggplot.html#cb346-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb346-17"><a href="exercise-5-graphics-with-ggplot.html#cb346-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-18"><a href="exercise-5-graphics-with-ggplot.html#cb346-18" aria-hidden="true" tabindex="-1"></a>g_temperature_polished <span class="ot">&lt;-</span> g_temperature <span class="sc">+</span> <span class="fu">theme_rbook</span>()</span>
<span id="cb346-19"><a href="exercise-5-graphics-with-ggplot.html#cb346-19" aria-hidden="true" tabindex="-1"></a>g_AQI_polished <span class="ot">&lt;-</span> g_AQI <span class="sc">+</span> <span class="fu">theme_rbook</span>()</span>
<span id="cb346-20"><a href="exercise-5-graphics-with-ggplot.html#cb346-20" aria-hidden="true" tabindex="-1"></a>g_temperature_AQI_polished <span class="ot">&lt;-</span> g_temperature_polished <span class="sc">/</span> g_AQI_polished</span>
<span id="cb346-21"><a href="exercise-5-graphics-with-ggplot.html#cb346-21" aria-hidden="true" tabindex="-1"></a>g_temperature_AQI_polished</span></code></pre></div>
<p>13. Finally, let’s try to change the scale limit settings on the x-axis and y-axis.For instance, we just want to display the AQI records less than 200,please refer to the <a href="https://nkaza.github.io/intro2Rbook/tips.html#axis-limits-and-zooms">Section 5.3.2 Axis limits and zooms</a> for more information and apply the <code>ylim(c(0, 200))</code> to change the faceting grid graph we generated just now between the day number of 2022 and AQI facetted on “omb” and “medinc” variables and different the “unemp” by different colors.You may also use the defined “theme_rbook” to polish it.</p>
<p> </p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="exercise-5-graphics-with-ggplot.html#cb347-1" aria-hidden="true" tabindex="-1"></a>g_AQI_zoomed <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">day_number</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">AQI</span><span class="st">`</span>, <span class="at">color =</span> <span class="st">`</span><span class="at">unemp</span><span class="st">`</span>), <span class="at">data =</span> AQI_March_Joint) <span class="sc">+</span></span>
<span id="cb347-2"><a href="exercise-5-graphics-with-ggplot.html#cb347-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span></span>
<span id="cb347-3"><a href="exercise-5-graphics-with-ggplot.html#cb347-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="sc">+</span></span>
<span id="cb347-4"><a href="exercise-5-graphics-with-ggplot.html#cb347-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="st">`</span><span class="at">omb</span><span class="st">`</span> <span class="sc">~</span> <span class="st">`</span><span class="at">medinc</span><span class="st">`</span>) <span class="sc">+</span></span>
<span id="cb347-5"><a href="exercise-5-graphics-with-ggplot.html#cb347-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">200</span>))</span>
<span id="cb347-6"><a href="exercise-5-graphics-with-ggplot.html#cb347-6" aria-hidden="true" tabindex="-1"></a>g_AQI_zoomed <span class="sc">+</span> <span class="fu">theme_rbook</span>()</span></code></pre></div>
<p>End of Exercise 5.</p>

<p> </p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="exercise-4-manipulating-data-with-tidyverse-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="exercise-5-graphics-with-ggplot-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/nkaza/intro2Rbook/edit/master/exercises/exercise_5_solution.Rmd",
"text": "Suggest an edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["Rbook.pdf", "Download PDF version"]],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"highlight": "tango"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
